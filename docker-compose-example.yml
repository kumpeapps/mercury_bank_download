services:
  # Database service (optional - if you want to include it here)
  # db:
  #   image: mysql:8.0
  #   environment:
  #     MYSQL_ROOT_PASSWORD: rootpassword
  #     MYSQL_DATABASE: Bot_mercury
  #     MYSQL_USER: Bot_mercury
  #     MYSQL_PASSWORD: password
  #   ports:
  #     - "3306:3306"
  #   networks:
  #     - mercury-network

  # Mercury sync service
  mercury-sync:
    image: "justinkumpe/mercury-bank-sync:latest"
    # Uncomment below for local development
    # build: ./sync_app
    environment:
      # Database configuration
      - DATABASE_URL=mysql+pymysql://Bot_mercury:passwrod@db:3306/Bot_mercury
      
      # Sync configuration
      - SYNC_DAYS_BACK=30
      - SYNC_INTERVAL_MINUTES=2
      - RUN_ONCE=false
    
    volumes:
      - ./sync_app/logs:/app/logs
    
    restart: unless-stopped
    
    networks:
      - mercury-network

  # Web application service
  web-app:
    image: "justinkumpe/mercury-bank-sync-gui:latest"
    # Uncomment below for local development
    # build: ./web_app
    environment:
      - DATABASE_URL=mysql+pymysql://Bot_mercury:password@db:3306/Bot_mercury
      - SECRET_KEY=your-secret-key-change-this-in-production
    
    ports:
      - "5001:5000"
    
    volumes:
      - ./web_app/logs:/app/logs
    
    restart: unless-stopped
    
    networks:
      - mercury-network

  # Database admin interface
  adminer:
    image: adminer:latest
    ports:
      - "8080:8080"
    restart: unless-stopped
    networks:
      - mercury-network

networks:
  mercury-network:
    driver: bridge
